var app=angular.module("myApp",["ui.router"]);app.config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("app",{url:"/app",templateUrl:"app/home.html"}),e.state("roster",{url:"/app/roster",templateUrl:"app/roster.html"}),e.state("clases",{url:"/app/clases",templateUrl:"app/clases.html"}),e.state("todo",{url:"/app/todo",templateUrl:"app/todo.html"}),e.state("info",{url:"/app/info",templateUrl:"app/info.html"}),e.state("recursos",{url:"/app/recursos",templateUrl:"app/recursos.html"}),e.state("dofitario",{url:"/app/dofitario",templateUrl:"app/dofitario.html"}),e.state("403",{url:"/403",template:"<h1>Not authorized</h1>"}),t.when("","/app")}]),angular.module("myApp").controller("MainCtrl",["$scope","$http","ApiFactory","$state",function(e,t,r,a){function n(){o.slots=l,o.generateUserList(),o.loadGenTable()}var o=this,l=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];o.generateUserList=function(){console.log("Generando lista"),r.getUserList().then(function(e){"Error"===e.data.response||(console.log(e),o.userList=e.data.users)})},o.loadTable=function(e){console.log(e),r.getTimetable(e).then(function(e){"Error"===e.data.response||(console.log(e),o.slots=e.data.week)})},o.deleteUser=function(e){console.log(r),r.deleteOne(e).then(function(e){"Error"===e.data.response||(console.log(e),o.generateUserList(),o.loadGenTable(),o.user="")})},o.saveTable=function(e,t){t=t||l,console.log(r),r.putTimetable(e,t).then(function(e){"Error"===e.data.response||(console.log(e),o.newUser="",o.generateUserList(),o.loadGenTable())})},o.resetTable=function(e){console.log(r),r.putTimetable(e,l).then(function(t){"Error"===t.data.response||(console.log(t),o.newUser="",o.slots=l,o.loadTable(e),o.loadGenTable())})},o.loadGenTable=function(){console.log(r),r.getGenTimetable().then(function(e){"Error"===e.data.response||(console.log(e),o.slots2=e.data.week)})},n()}]),angular.module("myApp").directive("genTimetable",function(){return{restrict:"A",templateUrl:"gen-timetable.tpl.html",scope:{slots:"="},link:function(e,t,r){function a(e,t,r){for(var a=[],n=e;n<=t;n+=r)a.push(n);return a}function n(){e.loop=a,e.days=o}var o=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];e.getColor=function(e){return e>=1&&e<3?"range1":e>=3&&e<5?"range2":e>=5&&e<7?"range3":e>=7&&e<9?"range4":e>=9?"range5":""},e.greaterThan=function(e){return e+=12,e>=24?e-24:e},n()}}}),angular.module("myApp").directive("ngEnter",function(){return function(e,t,r){t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$eval(r.ngEnter,{event:t})}),t.preventDefault())})}}),angular.module("myApp").directive("myTimetable",function(){return{restrict:"A",templateUrl:"my-timetable.tpl.html",scope:{slots:"="},link:function(e,t,r){function a(e,t,r){for(var a=[],n=e;n<=t;n+=r)a.push(n);return a}function n(t,r,a){var n=0;switch(t){case"day":for(u.day[r]=u.day[r]?0:1,n=0;n<=16;n++)e.slots[r][n]=u.day[r];break;case"hour":for(u.hour[a]=u.hour[a]?0:1,n=0;n<7;n++)e.slots[n][a]=u.hour[a];break;case"slot":u.state&&(e.slots[r][a]=e.slots[r][a]?0:1)}}function o(e,t,r){u.state=e,u.state&&n("slot",t,r)}function l(){e.loop=a,e.toggle=n,e.select=o,e.days=s}var s=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],u={state:!1,day:[0,0,0,0,0,0,0],hour:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};e.greaterThan=function(e){return e+=12,e>=24?e-24:e},l()}}}),angular.module("myApp").factory("ApiFactory",["$http",function(e){function t(t){return e.get(l+"api/users/"+t+"/week")}function r(t){return e.delete(l+"api/users/"+t+"/week")}function a(){return e.get(l+"api/general/week")}function n(){return e.get(l+"api/general/userlist")}function o(t,r){return e.put(l+"api/users/"+t+"/week",{nick:t,week:r})}var l="http://www.dofitos.tk/";return{getTimetable:t,getGenTimetable:a,putTimetable:o,getUserList:n,deleteOne:r}}]);